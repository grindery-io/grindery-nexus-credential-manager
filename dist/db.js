"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getCollection = getCollection;

var _mongodb = require("mongodb");

let cachedClient = null;

async function getDb() {
  if (cachedClient) {
    return (await cachedClient).db();
  } // eslint-disable-next-line @typescript-eslint/no-non-null-assertion


  cachedClient = _mongodb.MongoClient.connect(process.env.MONGODB_URI);
  cachedClient = await cachedClient;
  return cachedClient.db();
}

async function getCollection(collectionName) {
  const db = await getDb();
  return db.collection(collectionName);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9kYi50cyJdLCJuYW1lcyI6WyJjYWNoZWRDbGllbnQiLCJnZXREYiIsImRiIiwiTW9uZ29DbGllbnQiLCJjb25uZWN0IiwicHJvY2VzcyIsImVudiIsIk1PTkdPREJfVVJJIiwiZ2V0Q29sbGVjdGlvbiIsImNvbGxlY3Rpb25OYW1lIiwiY29sbGVjdGlvbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUVBLElBQUlBLFlBQXVELEdBQUcsSUFBOUQ7O0FBa0JBLGVBQWVDLEtBQWYsR0FBdUI7QUFDckIsTUFBSUQsWUFBSixFQUFrQjtBQUNoQixXQUFPLENBQUMsTUFBTUEsWUFBUCxFQUFxQkUsRUFBckIsRUFBUDtBQUNELEdBSG9CLENBSXJCOzs7QUFDQUYsRUFBQUEsWUFBWSxHQUFHRyxxQkFBWUMsT0FBWixDQUFvQkMsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFdBQWhDLENBQWY7QUFDQVAsRUFBQUEsWUFBWSxHQUFHLE1BQU1BLFlBQXJCO0FBQ0EsU0FBT0EsWUFBWSxDQUFDRSxFQUFiLEVBQVA7QUFDRDs7QUFDTSxlQUFlTSxhQUFmLENBQXVEQyxjQUF2RCxFQUE0RztBQUNqSCxRQUFNUCxFQUFFLEdBQUcsTUFBTUQsS0FBSyxFQUF0QjtBQUNBLFNBQU9DLEVBQUUsQ0FBQ1EsVUFBSCxDQUFjRCxjQUFkLENBQVA7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbGxlY3Rpb24sIE1vbmdvQ2xpZW50IH0gZnJvbSBcIm1vbmdvZGJcIjtcblxubGV0IGNhY2hlZENsaWVudDogTW9uZ29DbGllbnQgfCBQcm9taXNlPE1vbmdvQ2xpZW50PiB8IG51bGwgPSBudWxsO1xuXG50eXBlIERiU2NoZW1hID0ge1xuICBjb25uZWN0b3JTZWNyZXRzOiB7XG4gICAgY29ubmVjdG9ySWQ6IHN0cmluZztcbiAgICBzZWNyZXRzOiBzdHJpbmc7IC8vIEpTT04gc3RyaW5nXG4gICAgdXBkYXRlZEF0OiBudW1iZXI7IC8vIG1pbGxpc2Vjb25kcyBzaW5jZSBlcG9jaFxuICB9O1xuICBhdXRoQ3JlZGVudGlhbHM6IHtcbiAgICBjb25uZWN0b3JJZDogc3RyaW5nO1xuICAgIHVzZXJEaWQ6IHN0cmluZztcbiAgICBhdXRoQ3JlZGVudGlhbHM6IHN0cmluZzsgLy8gSlNPTiBzdHJpbmdcbiAgICBkaXNwbGF5TmFtZTogc3RyaW5nO1xuICAgIHVwZGF0ZWRBdDogbnVtYmVyOyAvLyBtaWxsaXNlY29uZHMgc2luY2UgZXBvY2hcbiAgICBjcmVhdGVkQXQ6IG51bWJlcjsgLy8gbWlsbGlzZWNvbmRzIHNpbmNlIGVwb2NoXG4gIH07XG59O1xuXG5hc3luYyBmdW5jdGlvbiBnZXREYigpIHtcbiAgaWYgKGNhY2hlZENsaWVudCkge1xuICAgIHJldHVybiAoYXdhaXQgY2FjaGVkQ2xpZW50KS5kYigpO1xuICB9XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbm9uLW51bGwtYXNzZXJ0aW9uXG4gIGNhY2hlZENsaWVudCA9IE1vbmdvQ2xpZW50LmNvbm5lY3QocHJvY2Vzcy5lbnYuTU9OR09EQl9VUkkhKTtcbiAgY2FjaGVkQ2xpZW50ID0gYXdhaXQgY2FjaGVkQ2xpZW50O1xuICByZXR1cm4gY2FjaGVkQ2xpZW50LmRiKCk7XG59XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q29sbGVjdGlvbjxUIGV4dGVuZHMga2V5b2YgRGJTY2hlbWE+KGNvbGxlY3Rpb25OYW1lOiBUKTogUHJvbWlzZTxDb2xsZWN0aW9uPERiU2NoZW1hW1RdPj4ge1xuICBjb25zdCBkYiA9IGF3YWl0IGdldERiKCk7XG4gIHJldHVybiBkYi5jb2xsZWN0aW9uKGNvbGxlY3Rpb25OYW1lKTtcbn1cbiJdfQ==